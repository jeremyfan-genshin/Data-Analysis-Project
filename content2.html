<div id="summary">
    <table>
        <thead>
            <tr>
                <th>速查表</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><a href="#content1">⭕ 資料庫正規化</a></td>
            </tr>
            <tr>
                <td><a href="#content2">⭕ Power BI：將文字欄位編碼為數值</a></td>
            </tr>
        </tbody>
    </table>
</div>
<div id="content1">
    <section class="section">
        <h1>資料庫正規化</h1>
        <h2>1. 資料庫正規化（Database Normalization）</h2>
        <p>
            指的是資料建模階段，將資料拆成多個有邏輯關係的表（例如：把「客戶」、「訂單」拆開），目的是避免重複、提升效率與一致性。
        </p>
        <p><strong>例如：</strong><br>
            一張表有多筆重複的「客戶名稱」：可抽出為「客戶表」，以 <code>CustomerID</code> 關聯回訂單表。</p>
        <p>拆成 <strong>維度表</strong> 與 <strong>事實表</strong></p>
        <p><strong>在 Power BI 中這種正規化通常是：</strong></p>
        <ul>
            <li>在 Power Query 中拆表（Group by + Merge）</li>
            <li>或在資料來源前（如 SQL）先行正規化</li>
        </ul>
        <hr>
    </section>

    <section class="section">
        <h2>2. 數值正規化（Numeric Normalization / 標準化）</h2>
        <p>
            是指把數值欄位標準化成某個範圍，比如：
        </p>
        <ul>
            <li><strong>Min-Max 正規化：</strong>把數值轉成 0 到 1 之間<br>
                <code>Normalized = (Value - Min) / (Max - Min)</code>
            </li>
            <li><strong>Z-score 標準化：</strong>常用於統計、ML 模型<br>
                <code>Z = (X - Mean) / StdDev</code>
            </li>
        </ul>
        <p><strong>在 Power BI 中，這可以用：</strong></p>
        <ul>
            <li>Power Query（M 語言）來加欄位運算</li>
            <li>或在報表中用 DAX 寫計算欄位/度量值</li>
        </ul>
        <hr>
    </section>

    <section class="section">
        <h2>3. 文字正規化（Text Normalization）</h2>
        <p>
            像是去除多餘空白、轉小寫、清除符號等，可在 Power Query 中使用：
        </p>
        <pre><code>Text.Trim(Text.Lower([欄位名稱]))</code></pre>
        <hr>
    </section>
</div>
<div id="content2">
    <h1>Power BI：將文字欄位編碼為數值</h1>

    <section class="section">
        <h2>概念說明</h2>
        <p>在 Power BI 或 Power Query 中，將某個「文字欄位」用對應的「數值」取代，是一種常見的 <strong>編碼（Encoding）</strong> 方法，尤其在：</p>
        <ul>
            <li>資料前處理</li>
            <li>分類變數轉為數值（如做數據分析或機器學習）</li>
        </ul>
        <hr>
    </section>

    <section class="section">
        <h2>範例說明</h2>
        <p>假設有一欄「顏色」如下：</p>
        <table>
            <tr>
                <th>顏色</th>
            </tr>
            <tr>
                <td>紅色</td>
            </tr>
            <tr>
                <td>藍色</td>
            </tr>
            <tr>
                <td>綠色</td>
            </tr>
        </table>

        <p>您希望轉換為：</p>
        <table>
            <tr>
                <th>顏色</th>
                <th>顏色代碼</th>
            </tr>
            <tr>
                <td>紅色</td>
                <td>1</td>
            </tr>
            <tr>
                <td>藍色</td>
                <td>2</td>
            </tr>
            <tr>
                <td>綠色</td>
                <td>3</td>
            </tr>
        </table>
    </section>

    <section class="section">
        <h2>方法一：使用 Power Query 條件邏輯</h2>
        <ol>
            <li>進入 Power Query 編輯器，選擇您的主表。</li>
            <li>點選「<strong>新增資料欄</strong>」 > 「<strong>條件欄位</strong>」。</li>
            <li>設定條件如下：</li>
        </ol>

        <ul>
            <li>如果 顏色 = 紅色，則 1</li>
            <li>如果 顏色 = 藍色，則 2</li>
            <li>如果 顏色 = 綠色，則 3</li>
        </ul>

        <p><strong>結果：</strong>會產生一個名為「顏色代碼」的新欄位。</p>

        <p><strong>生成的 M 語法如下：</strong></p>
        <pre>
= Table.AddColumn(原始表, "顏色代碼", each 
    if [顏色] = "紅色" then 1 
    else if [顏色] = "藍色" then 2 
    else if [顏色] = "綠色" then 3 
    else null)
        </pre>
        <hr>
    </section>

    <section class="section">
        <h2>方法二：建立對照表 + 合併查詢（推薦）</h2>
        <p>若文字與數值對應較多，建議用「合併查詢」搭配「對照表」處理。</p>

        <p><strong>對照表範例如下：</strong></p>
        <table>
            <tr>
                <th>顏色</th>
                <th>顏色代碼</th>
            </tr>
            <tr>
                <td>紅色</td>
                <td>1</td>
            </tr>
            <tr>
                <td>藍色</td>
                <td>2</td>
            </tr>
            <tr>
                <td>綠色</td>
                <td>3</td>
            </tr>
        </table>

        <p><strong>步驟：</strong></p>
        <ol>
            <li>將對照表也載入到 Power BI。</li>
            <li>在 Power Query 編輯器中，選擇主表，點選「合併查詢」。</li>
            <li>以主表的「顏色」對應對照表的「顏色」。</li>
            <li>合併後展開欄位，選擇「顏色代碼」。</li>
        </ol>
        <hr>
    </section>

    <section class="section">
        <h2>小技巧：使用 DAX 實作（模型階段處理）</h2>
        <p>如果要在 DAX 層級處理，也可以用 <code>SWITCH</code> 函數：</p>
        <pre>
顏色代碼 = 
SWITCH(
    TRUE(),
    [顏色] = "紅色", 1,
    [顏色] = "藍色", 2,
    [顏色] = "綠色", 3,
    BLANK()
)
        </pre>
        <p><strong>建議：</strong>若可行，盡量在 Power Query 階段先完成轉換，模型會更乾淨且可維護性更高。</p>
    </section>
</div>